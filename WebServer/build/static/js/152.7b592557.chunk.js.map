{"version":3,"file":"static/js/152.7b592557.chunk.js","mappings":"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","sources":["states/page/file-share/sharedtome/index.ts","components/file-share/shared-to-me/ShredToMeFileOperationMenu/index.tsx","components/file-share/shared-to-me/SharedToMe.tsx","pages/file-share/SharedToMe.tsx","utils/sizeToString.ts"],"sourcesContent":["import { Dispatch, SetStateAction, useState } from 'react'\nimport { useStore } from 'reto'\nimport { ConfirmDeleteDialogStore } from 'src/states/common/ConfirmDeleteDialogStore'\nimport { LoadingStore } from 'src/states/common/LoadingStore'\nimport { FileItemData } from 'src/types/ComponentProps'\n\ntype SnackBarType = 'success' | 'error' | 'warning' | 'info'\n\n// 新建数据通道\nexport interface SharedToMeStates {\n  files: FileItemData[]\n}\n\nexport interface SharedToMeStore\n  extends SharedToMeStates,\n  LoadingStore {\n  setFiles: Dispatch<SetStateAction<any[]>>\n}\n\nexport function SharedToMeStore(): SharedToMeStore {\n  const loadingStore = useStore(LoadingStore)\n  const confirmDeleteDialogStore = useStore(ConfirmDeleteDialogStore)\n  const [files, setFiles] = useState<any[]>([])\n  return {\n    ...loadingStore,\n    ...confirmDeleteDialogStore,\n    files,\n    setFiles\n  }\n}\n","import { Delete, ErrorOutline, Share } from '@material-ui/icons';\nimport { Box, Stack } from '@mui/material';\nimport { FolderArrowUp } from 'mdi-material-ui';\nimport OperationItem from 'src/components/common/OperationItem';\nimport Section from 'src/components/common/Section';\nimport SimpleFileItem from 'src/components/common/SimpleFileItem';\nimport VerticalList from 'src/components/common/VerticalList';\nimport { FileOperationMenuProps } from '../../../../types/ComponentProps';\n\n\n\nconst ShredToMeFileOperationMenu = ({ fileName, onOperationClicked }: FileOperationMenuProps) => {\n    return (\n        <Stack m={1}>\n            <Box borderRadius={3}>\n                <SimpleFileItem fileName={fileName} />\n                <Section title='文件操作'>\n                    <VerticalList items={[\n                        <OperationItem icon={<FolderArrowUp fontSize='large' />} name={'打开'} onclick={() => onOperationClicked('open')} />,\n                        <OperationItem icon={<Share fontSize='large' />} name={'共享'} onclick={() => onOperationClicked('share')} />,\n                        <OperationItem icon={<Delete fontSize='large' />} name={'删除'} onclick={() => onOperationClicked('delete')} />\n                    ]} />\n                </Section>\n                <Section title='更多操作'>\n                    <VerticalList items={[\n                        <OperationItem icon={<ErrorOutline fontSize='large' />} name={'详细信息'} onclick={() => onOperationClicked('detail')} />\n                    ]} />\n                </Section>\n            </Box>\n\n        </Stack>\n    )\n\n}\n\n\nexport default ShredToMeFileOperationMenu\n","import { Box, Fade } from \"@mui/material\"\nimport { useEffect } from \"react\"\nimport { useNavigate } from \"react-router\"\nimport { useStore } from 'reto'\nimport FileState from \"src/components/common/FileState\"\nimport { getPolicies } from \"src/service/policyApi\"\nimport { SharedToMeStore } from \"src/states/page/file-share/sharedtome\"\nimport { BottomDrawerStore } from '../../../states/global/BottomDrawerStore'\nimport FileItem from \"../../common/FileItem\"\nimport VerticalList from \"../../common/VerticalList\"\nimport SharedToMeFileOperationMenu from \"./ShredToMeFileOperationMenu\"\nimport { FileToFileItemData, getFileList } from \"src/service/medic\"\nimport { toLocalTimeString } from \"src/utils/time\"\nimport { sizeToString } from \"src/utils/sizeToString\"\n\nconst SharedToMeWrapper = () => {\n  const navi = useNavigate()\n  const states = useStore(SharedToMeStore)\n  const drawerStates = useStore(BottomDrawerStore)\n  useEffect(() => {\n    getFileList().then(res => {\n      if (res && res.code === 0) {\n        if (Array.isArray(res.data)) {\n          states.setFiles(res.data\n            .map((item, idx) => {\n              return FileToFileItemData(idx, item)\n            }))\n          states.setLoading(false)\n        } else {\n          states.setFiles([res.data])\n        }\n      }\n    })\n  }, [])\n\n  const handleFileOperation = (ty: any, index: number) => {\n    switch (ty) {\n      case 'delete':\n        console.log('delete files at index', index);\n        break;\n      case 'open':\n        drawerStates.setBottomDrawerOpen(false)\n        console.log(states.files)\n        navi('/pdfpreview', { state: states.files[index] })//传入Id值\n        break;\n        break;\n      case 'share':\n        console.log('share files at index', index);\n        break;\n      case 'detail':\n        console.log('detail files at index', index);\n        break;\n    }\n  }\n  const onOperationClicked = (index: number) => {\n    drawerStates.setBottomDrawerOpen(true)\n    drawerStates.setBottomDrawerContent(\n      <SharedToMeFileOperationMenu fileName={states.files[index].name} onOperationClicked={(ty) => handleFileOperation(ty, index)} />\n    )\n  }\n\n  return (\n    <Fade in={true}>\n      <Box>\n        <VerticalList items={states.files?.map((SharedItems, index) => {\n          console.log(SharedItems)\n          return <FileItem\n            key={index}\n            fileName={SharedItems.name}\n            fileTime={toLocalTimeString(SharedItems.expire)}\n            fileSize={sizeToString(SharedItems.size)}\n            sharedContent={<FileState state={'shared'} />}\n            onOperationClicked={() => onOperationClicked(index)} />\n        })} onItemClicked={onOperationClicked} />\n      </Box>\n    </Fade>\n  )\n}\nexport default SharedToMeWrapper\n","import { Provider } from 'reto';\nimport SharedToMeWrapper from '../../components/file-share/shared-to-me/SharedToMe';\nimport { SharedToMeStore } from '../../states/page/file-share/sharedtome/index';\nconst SharedToMePage = () => {\n    return (\n        <Provider of={SharedToMeStore}>\n            <SharedToMeWrapper />\n        </Provider>\n    )\n}\n\nexport default SharedToMePage\n","export function sizeToString(size: number) {\n    var data = \"\";\n    if (size < 0.1 * 1024) { //如果小于0.1KB转化成B  \n        data = size.toFixed(2) + \"B\";\n    } else if (size < 0.1 * 1024 * 1024) {//如果小于0.1MB转化成KB  \n        data = (size / 1024).toFixed(2) + \"KB\";\n    } else if (size < 0.1 * 1024 * 1024 * 1024) { //如果小于0.1GB转化成MB  \n        data = (size / (1024 * 1024)).toFixed(2) + \"MB\";\n    } else { //其他转化成GB  \n        data = (size / (1024 * 1024 * 1024)).toFixed(2) + \"GB\";\n    }\n    var sizestr = data + \"\";\n    var len = sizestr.indexOf(\"\\.\");\n    var dec = sizestr.substr(len + 1, 2);\n    if (dec == \"00\") {//当小数点后为00时 去掉小数部分  \n        return sizestr.substring(0, len) + sizestr.substr(len + 3, 2);\n    }\n    return sizestr;\n}  \n"],"names":["SharedToMeStore","loadingStore","useStore","LoadingStore","confirmDeleteDialogStore","ConfirmDeleteDialogStore","useState","files","setFiles","fileName","onOperationClicked","Stack","m","Box","borderRadius","SimpleFileItem","Section","title","VerticalList","items","OperationItem","icon","FolderArrowUp","fontSize","name","onclick","Share","Delete","ErrorOutline","navi","useNavigate","states","drawerStates","BottomDrawerStore","useEffect","getFileList","then","res","code","Array","isArray","data","map","item","idx","FileToFileItemData","setLoading","index","setBottomDrawerOpen","setBottomDrawerContent","ty","console","log","state","handleFileOperation","Fade","in","SharedItems","FileItem","fileTime","toLocalTimeString","expire","fileSize","sizeToString","size","sharedContent","FileState","onItemClicked","of","SharedToMe","sizestr","toFixed","len","indexOf","substr","substring"],"sourceRoot":""}