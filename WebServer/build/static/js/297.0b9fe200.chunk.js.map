{"version":3,"file":"static/js/297.0b9fe200.chunk.js","mappings":"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","sources":["components/common/FileList/index.tsx","components/file-manage/FileOperationMenu/index.tsx","../node_modules/@material-ui/icons/esm/FileCopy.js","components/file-manage/index.tsx","pages/file-manage/index.tsx","styles/NoUserSelect.ts"],"sourcesContent":["import { sizeToString } from 'src/utils/sizeToString';\nimport { toLocalTimeString } from 'src/utils/time';\nimport { FileListProps } from '../../../types/ComponentProps';\nimport FileItem from \"../FileItem\";\nimport FileState from '../FileState';\nimport VerticalList from \"../VerticalList\";\n\n\nconst FileList = ({ items, onOperationClicked }: FileListProps) => {\n    return (\n        <VerticalList items={\n            items.map((item, index) => {\n                return <FileItem key={index}\n                    fileName={item.name}\n                    fileSize={sizeToString(item.size)}\n                    fileTime={toLocalTimeString(item.expire)}\n                    remainUse={item.useLimit - item.use}\n                    sharedContent={<FileState state={item.state} />}\n                    onOperationClicked={() => onOperationClicked(index)}\n                />\n            })\n        } />\n    )\n\n}\n\n\nexport default FileList\n","import { Delete, ErrorOutline, Share } from '@material-ui/icons';\nimport { Box, Stack } from '@mui/material';\nimport { FolderArrowUp } from 'mdi-material-ui';\nimport OperationItem from 'src/components/common/OperationItem';\nimport Section from 'src/components/common/Section';\nimport SimpleFileItem from 'src/components/common/SimpleFileItem';\nimport VerticalList from 'src/components/common/VerticalList';\nimport { FileOperationMenuProps } from '../../../types/ComponentProps';\n\n\n\nconst FileOperationMenu = ({ fileName, onOperationClicked }: FileOperationMenuProps) => {\n    return (\n        <Stack m={1}>\n            <Box borderRadius={3}>\n                <SimpleFileItem fileName={fileName} />\n                <Section title='文件操作'>\n                    <VerticalList items={[\n                        <OperationItem icon={<FolderArrowUp fontSize='large' />} name={'打开'} onclick={() => onOperationClicked('open')} />,\n                        <OperationItem icon={<Share fontSize='large' />} name={'共享'} onclick={() => onOperationClicked('share')} />,\n                        <OperationItem icon={<Delete fontSize='large' />} name={'删除'} onclick={() => onOperationClicked('delete')} />\n                    ]} />\n                </Section>\n                <Section title='更多操作'>\n                    <VerticalList items={[\n                        <OperationItem icon={<ErrorOutline fontSize='large' />} name={'详细信息'} onclick={() => onOperationClicked('detail')} />\n                    ]} />\n                </Section>\n            </Box>\n\n        </Stack>\n    )\n\n}\n\n\nexport default FileOperationMenu\n","import * as React from 'react';\nimport createSvgIcon from './utils/createSvgIcon';\nexport default createSvgIcon( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z\"\n}), 'FileCopy');","import { BottomDrawerStore } from \"src/states/global/BottomDrawerStore\";\nimport { FileItemData, FileManageOperationType, SpeedDialMenuOptionProps } from \"src/types/ComponentProps\";\nimport { Fade, Stack, Zoom } from \"@mui/material\";\nimport { useEffect, useState } from \"react\";\nimport { useStore, Provider } from \"reto\";\nimport FileList from 'src/components/common/FileList';\nimport Section from \"../common/Section\";\nimport FileOperationMenu from \"./FileOperationMenu\";\nimport { noUserSelect } from \"src/styles/NoUserSelect\";\nimport SpeedDialMenu from \"../common/PopMenu\";\nimport { Favorite, FileCopy, Print, Save, Share } from \"@material-ui/icons\";\nimport { BookOutline } from \"mdi-material-ui\";\nimport { useNavigate } from \"react-router\";\nimport { bool } from \"prop-types\";\nimport { getFileList } from \"src/service/medic\"\nconst FileManageWrapper = () => {\n    const bottomeDrawerStates = useStore(BottomDrawerStore)\n    const navi = useNavigate()\n    const actions: SpeedDialMenuOptionProps[] = [\n        { icon: <FileCopy fontSize=\"large\" />, name: '新建共享资源', onClick: () => { navi('/filemanage/create') } },\n        { icon: <BookOutline fontSize=\"large\" />, name: '添加策略', onClick: () => { navi('/policymanage/create') } },\n    ];\n    const [files, setFiles] = useState<FileItemData[]>([]);\n    // 使用 useEffect 来在组件挂载后获取数据\n    useEffect(() => {\n        // 获取文件数据\n        getFileList().then((res) => {\n            console.log(res)\n            setFiles(res.data.map((item, idx) => {\n                const owner = localStorage.getItem('username')\n                return {\n                    id: idx,\n                    name: item.fileName,\n                    size: item.fileSize,\n                    state: owner == item.owner ? 'owned' : 'fromShared',\n                    owner: item.owner,\n                    use: item.use,\n                    useLimit: item.useLimit,\n                    expire: item.expire\n                }\n            }))\n        })\n    }, []); // 空依赖数组意味着这个 useEffect 只会在组件挂载后执行一次\n\n    const handleFileOperation = (ty: FileManageOperationType, index: number) => {\n        console.log(index)\n        switch (ty) {\n            case 'delete':\n                console.log('delete files at index', index);\n                break;\n            case 'open':\n                bottomeDrawerStates.setBottomDrawerOpen(false)\n                navi('/pdfpreview', { state: files[index] })//传入Id值\n                break;\n            case 'share':\n                bottomeDrawerStates.setBottomDrawerOpen(false)\n                navi('/policymanage/create', { state: { id: files[index].name } })//传入Id值\n                break;\n            case 'detail':\n                console.log('detail files at index', index);\n                break;\n        }\n    }\n\n    const onOperationClickHandler = (index: number) => {\n        bottomeDrawerStates.setBottomDrawerOpen(true)\n        bottomeDrawerStates.setBottomDrawerContent(\n            <FileOperationMenu fileName={files[index].name} onOperationClicked={(ty) => handleFileOperation(ty, index)} />\n        )\n    }\n    const noSelect = noUserSelect()\n    return (\n        <Fade in={true}>\n            <Stack className={noSelect.root}>\n                <Section title={'所有文件'}>\n                    <FileList items={files} onOperationClicked={onOperationClickHandler} />\n                </Section>\n                {/* <SpeedDialMenu options={actions} /> */}\n            </Stack>\n        </Fade>\n    )\n}\nexport default FileManageWrapper\n","// ** MUI Imports\n// ** Icons Imports\n// ** Demo Components Imports\nimport FileManageWrapper from 'src/components/file-manage';\nimport { Provider } from 'reto';\nimport { BottomDrawerStore } from 'src/states/global/BottomDrawerStore';\nimport { Zoom } from '@mui/material';\n\n\nconst FileManagePage = () => {\n  return <FileManageWrapper />\n}\n\nexport default FileManagePage\n","import { makeStyles } from \"@material-ui/core\";\n\nexport const noUserSelect = makeStyles({\n    root: {\n        '& > *': { userSelect: 'none' }\n    }\n})\n"],"names":["items","onOperationClicked","VerticalList","map","item","index","FileItem","fileName","name","fileSize","sizeToString","size","fileTime","toLocalTimeString","expire","remainUse","useLimit","use","sharedContent","FileState","state","Stack","m","Box","borderRadius","SimpleFileItem","Section","title","OperationItem","icon","FolderArrowUp","fontSize","onclick","Share","Delete","ErrorOutline","createSvgIcon","React","d","bottomeDrawerStates","useStore","BottomDrawerStore","navi","useNavigate","BookOutline","useState","files","setFiles","useEffect","getFileList","then","res","console","log","data","idx","owner","localStorage","getItem","id","noSelect","noUserSelect","Fade","in","className","root","setBottomDrawerOpen","setBottomDrawerContent","ty","handleFileOperation","makeStyles","userSelect"],"sourceRoot":""}